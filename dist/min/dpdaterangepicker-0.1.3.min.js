/* 
*  Name: dpdaterangepicker 
*  Description: Date range picker - AngularJS reusable UI component 
*  Version: 0.1.3 
*  Author: kekeh 
*  Homepage: http://kekeh.github.io/dpdaterangepicker 
*  License: MIT 
*  Date: 2015-09-06 
*/ 
angular.module('template-dpdaterangepicker-0.1.3.html', []).run(['$templateCache', function($templateCache) {
  $templateCache.put("templates/dpdaterangepicker.html",
    "<div class=dpdaterangepicker ng-style=\"{'width':width}\"><div class=vstooltip ng-show=showTooltip ng-mouseleave=\"showTooltip=false\"><span class=vstooltiptext>{{selectedRangeTxt}}</span></div><div class=dpselectiongroup ng-click=picker($event)><span class=dpselection ng-style=\"{'line-height': height}\" ng-click=picker($event) tooltip-window>{{selectedRangeTxt}}</span> <span class=dpselbtngroup ng-style=\"{'height': height}\"><button class=dpbtnclear ng-show=\"selectedRangeTxt.length > 0\" ng-click=clearSelection($event)><span class=\"icon icon-cross\"></span></button> <button class=dpbtnpicker ng-click=picker($event)><span class=\"icon icon-calendar\"></span></button></span></div><div class=dpselector ng-if=showSelector><div class=dptitlearea ng-class=\"{'dptitlerangeok': rangeOk, 'dptitlerangenotok': !rangeOk}\"><div class=dptitleareatxt>{{titleTxt}}</div></div><table class=dpheader><tr><td><div style=float:left><div class=dpheaderbtn ng-click=prevMonth()><span class=\"icon icon-left\"></span></div><div class=dpheadermonthtxt ng-bind=visibleMonth.monthTxt></div><div class=dpheaderbtn ng-click=nextMonth()><span class=\"icon icon-right\"></span></div></div></td><td><button class=dpheadertodaybtn ng-click=today()>{{options.buttons.todayBtnText!==undefined?options.buttons.todayBtnText:cf.buttons.todayBtnText}}</button></td><td><div style=float:right><div class=dpheaderbtn ng-click=prevYear()><span class=\"icon icon-left\"></span></div><div class=dpheaderyeartxt ng-bind=visibleMonth.year></div><div class=dpheaderbtn ng-click=nextYear()><span class=\"icon icon-right\"></span></div></div></td></tr></table><table class=dptable><thead><tr><th ng-class=\"{'dpnogrid': !showGrid}\" ng-repeat=\"d in weekDays track by $index\" ng-bind=d></th></tr></thead><tbody><tr ng-repeat=\"w in dates track by $index\"><td ng-repeat=\"d in w track by $index\" ng-class=\"{'dpnogrid':!showGrid,'dpcurrmonth':d.cmo===cf.CURR_MONTH,'dpcurrday':d.currDay && (options.currDayHighlight!==undefined?options.currDayHighlight:cf.currDayHighlight),'dpselectedday':selectedDate.day===d.day && selectedDate.month===d.month && selectedDate.year===d.year && d.cmo===cf.CURR_MONTH}\" ng-click=cellClicked(d)><span style=background-color:inherit ng-class=\"{'dpprevmonth':d.cmo===cf.PREV_MONTH,'dpcurrmonth':d.cmo===cf.CURR_MONTH,'dpnextmonth':d.cmo===cf.NEXT_MONTH,'dpsunday':d.sun && d.cmo===cf.CURR_MONTH && (options.sunHighlight!==undefined?options.sunHighlight:cf.sunHighlight)}\" ng-bind=d.day></span></td></tr></tbody></table><div class=dpfooterarea><button class=dpfooterbtn ng-class=\"{'dpbtndisable': !rangeOk}\" ng-disabled=!rangeOk ng-show=beginDateStep ng-click=toEndDate()>{{options.buttons.nextBtnText!==undefined?options.buttons.nextBtnText:cf.buttons.nextBtnText}}</button> <button class=dpfooterbtn ng-show=!beginDateStep ng-click=toBeginDate()>{{options.buttons.prevBtnText!==undefined?options.buttons.prevBtnText:cf.buttons.prevBtnText}}</button> <button class=dpfooterbtn ng-class=\"{'dpbtndisable': !rangeOk}\" ng-disabled=!rangeOk ng-show=!beginDateStep ng-click=accept()>{{options.buttons.okBtnText!==undefined?options.buttons.okBtnText:cf.buttons.okBtnText}}</button></div></div></div>");
}]);

angular.module("dpdaterangepicker",["template-dpdaterangepicker-0.1.3.html"]).constant("dpdaterangeConfig",{monthLabels:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},dayLabels:{su:"Sun",mo:"Mon",tu:"Tue",we:"Wed",th:"Thu",fr:"Fri",sa:"Sat"},dateFormat:"yyyy-mm-dd",firstDayOfWeek:"su",showGrid:!0,buttons:{todayBtnText:"Today",nextBtnText:"Next",prevBtnText:"Previous",okBtnText:"OK"},beginDateText:"begin date",endDateText:"end date",sunHighlight:!0,currDayHighlight:!0,YEAR_CONST:"yyyy",MONTH_CONST:"mm",DATE_CONST:"dd",PREV_MONTH:1,CURR_MONTH:2,NEXT_MONTH:3,DATES_SEPARATOR:" - ",TOOLTIP_SHOW_DELAY:600,HEIGHT:"30px",WIDTH:"260px"}).directive("dpdaterangepicker",["$timeout","$document",function(a,b){return{restrict:"EA",templateUrl:"templates/dpdaterangepicker.html",scope:{ngModel:"=?",options:"="},controller:["$scope","dpdaterangeConfig",function(a,b){a.cf=b,a.showTooltip=!1}],link:function(c,d,e){function f(a,b){c.options.dateRangeSelectCb&&c.options.dateRangeSelectCb({day:a.day,month:a.month,year:a.year,formatted:i(a)},{day:b.day,month:b.month,year:b.year,formatted:i(b)},c.selectedRangeTxt),c.ngModel=c.selectedRangeTxt}function g(a,b){c.selectedDate={day:0,month:0,year:0},c.titleTxt=a,c.beginDateStep=b,c.rangeOk=!1}function h(a){if(c.selectedDate={day:a.day,month:a.month,year:a.year},c.beginDateStep)c.rangeOk=!0,c.titleTxt=i(a),w=angular.copy(c.selectedDate);else{var b=new Date(w.year,w.month-1,w.day),d=new Date(c.selectedDate.year,c.selectedDate.month-1,c.selectedDate.day);c.rangeOk=d>=b,c.titleTxt=i(w)+c.cf.DATES_SEPARATOR+i(a)}}function i(a){if(0===a.day&&0===a.month&&0===a.year)return"";var b=angular.copy(angular.isUndefined(c.options.dateFormat)?c.cf.dateFormat:c.options.dateFormat);return b.replace(c.cf.YEAR_CONST,a.year).replace(c.cf.MONTH_CONST,j(a.month)).replace(c.cf.DATE_CONST,j(a.day))}function j(a){return 10>a?"0"+a:a}function k(a){return s()[a]}function l(a,b){var c=new Date;c.setDate(1),c.setMonth(b-1),c.setYear(a);var d=c.getDay()+m();return d>=7?d-7:d}function m(){return v>0?7-v:0}function n(a,b){return new Date(b,a,0).getDate()}function o(a,b){return 1===a?(a=12,b--):a--,n(a,b)}function p(a,b,c,d){return a===x.getDate()&&b===x.getMonth()+1&&c===x.getFullYear()&&2===d}function q(a,b){c.dates.length=0;for(var d=l(b,a),e=n(a,b),f=o(a,b),g=m(),h=1,i=c.cf.PREV_MONTH,j=1;7>j;j++){var k=[];if(1===j){for(var q=f-d+1,r=q;f>=r;r++)k.push({day:r,month:a,year:b,cmo:i,currDay:p(r,a,b,i),sun:k.length===g});i=c.cf.CURR_MONTH;for(var s=7-k.length,r=0;s>r;r++)k.push({day:h,month:a,year:b,cmo:i,currDay:p(h,a,b,i),sun:k.length===g}),h++}else for(var r=1;8>r;r++)h>e&&(h=1,i=c.cf.NEXT_MONTH),k.push({day:h,month:a,year:b,cmo:i,currDay:p(h,a,b,i),sun:k.length===g}),h++;c.dates.push(k)}}function r(a){d[0].contains(a.target)||1!==a.which||(c.showSelector&&(c.showSelector=!1),c.$apply())}function s(){return angular.isUndefined(c.options.monthLabels)?c.cf.monthLabels:c.options.monthLabels}function t(){return angular.isUndefined(c.options.dayLabels)?c.cf.dayLabels:c.options.dayLabels}function u(){c.showGrid=angular.isUndefined(c.options.showGrid)?c.cf.showGrid:c.options.showGrid,c.height=angular.isUndefined(e.height)?c.height:e.height,c.width=angular.isUndefined(e.width)?c.width:e.width;var a=["su","mo","tu","we","th","fr","sa"];if(v=a.indexOf(angular.isUndefined(c.options.firstDayOfWeek)?c.cf.firstDayOfWeek:c.options.firstDayOfWeek),-1!==v)for(var d=v,f=0;f<a.length;f++)c.weekDays.push(t()[a[d]]),d="sa"===a[d]?0:d+1;void 0!==c.options.initSelectedDateRange&&(c.selectedRangeTxt=i(c.options.initSelectedDateRange.begin)+c.cf.DATES_SEPARATOR+i(c.options.initSelectedDateRange.end)),b.on("click",r)}c.dates=[],c.weekDays=[],c.selectedRangeTxt="",c.titleTxt="",c.showSelector=!1,c.rangeOk=!1,c.beginDateStep=!0,c.selectedDate={day:0,month:0,year:0},c.visibleMonth={monthTxt:"",monthNbr:0,year:0},c.width=c.cf.WIDTH,c.height=c.cf.HEIGHT;var v=0,w={day:0,month:0,year:0},x=new Date;c.prevMonth=function(){var a=c.visibleMonth.monthNbr,b=c.visibleMonth.year;1===a?(a=12,b--):a--,c.visibleMonth={monthTxt:k(a),monthNbr:a,year:b}},c.nextMonth=function(){var a=c.visibleMonth.monthNbr,b=c.visibleMonth.year;12===a?(a=1,b++):a++,c.visibleMonth={monthTxt:k(a),monthNbr:a,year:b}},c.prevYear=function(){c.visibleMonth.year--},c.nextYear=function(){c.visibleMonth.year++},c.today=function(){var a=x.getMonth()+1;c.visibleMonth={monthTxt:k(a),monthNbr:a,year:x.getFullYear()}},c.cellClicked=function(a){a.cmo===c.cf.PREV_MONTH?c.prevMonth():a.cmo===c.cf.CURR_MONTH?h(a):a.cmo===c.cf.NEXT_MONTH&&c.nextMonth()},c.toBeginDate=function(){c.selectedDate=w,c.titleTxt=i(w),c.beginDateStep=!0,c.rangeOk=!0},c.toEndDate=function(){g(angular.isUndefined(c.options.endDateText)?c.cf.endDateText:c.options.endDateText,!1)},c.accept=function(){c.selectedRangeTxt=c.titleTxt,c.showSelector=!1,f(w,c.selectedDate)},c.picker=function(a){if(a.stopPropagation(),c.showSelector=!c.showSelector,c.showSelector){g(angular.isUndefined(c.options.beginDateText)?c.cf.beginDateText:c.options.beginDateText,!0);var b=0,d=0;void 0===c.options.initSelectorMonth?(b=x.getFullYear(),d=x.getMonth()+1):(b=c.options.initSelectorMonth.year,d=c.options.initSelectorMonth.month),c.visibleMonth={monthTxt:s()[d],monthNbr:d,year:b},q(d,b)}},c.clearSelection=function(a){a.stopPropagation(),c.selectedRangeTxt="",c.selectedDate={day:0,month:0,year:0},f(c.selectedDate,c.selectedDate)},c.$watch("visibleMonth",function(a,b){a!==b&&q(a.monthNbr,a.year)},!0),c.$watch("ngModel",function(a,b){a!==b&&""===a&&(c.selectedRangeTxt=a)}),c.$on("$destroy",function(){b.off("click",r)}),a(u)}}}]).directive("tooltipWindow",["$timeout",function(a){return{restrict:"A",scope:!1,link:function(b,c,d){function e(){c[0].scrollWidth>c[0].offsetWidth&&a(function(){b.showTooltip=!0},b.cf.TOOLTIP_SHOW_DELAY)}function f(){c.on("mouseenter",e)}b.$on("$destroy",function(){c.off("mouseenter",e)}),f()}}}]);